generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "sqlite"
}

model Entity {
  id        String          @id @default(cuid())
  name      String
  parentId  String?
  parent    Entity?         @relation("EntityTree", fields: [parentId], references: [id])
  children  Entity[]        @relation("EntityTree")
  problems  EntityProblem[]
  createdAt DateTime        @default(now())
  updatedAt DateTime        @updatedAt
}

model Problem {
  id          String          @id @default(cuid())
  title       String
  description String?
  impact      String?
  opportunity String?
  state       String          @default("identified")
  entities    EntityProblem[]
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
}

model EntityProblem {
  id        String   @id @default(cuid())
  entityId  String
  problemId String
  entity    Entity   @relation(fields: [entityId], references: [id])
  problem   Problem  @relation(fields: [problemId], references: [id])
  createdAt DateTime @default(now())

  @@unique([entityId, problemId])
}
